///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

// Copyright (c) 1998,  MicroProse, Inc.  All Rights Reserved

extern "C" {
#include <stdio.h>
#include <string.h>
#include <assert.h>
};

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#include "vu2.h"
#include "vu_priv.h"

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#define KILL_ARRAY_SIZE    100
#define MAX_ITERATOR_COUNT 256

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#ifdef USE_SH_POOLS
MEM_POOL VuLinkNode::pool;
MEM_POOL vuRBNodepool;
MEM_POOL gVuFilterMemPool;
#endif

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

VuCollectionManager* vuCollectionManager = 0;
VuDatabase*          vuDatabase          = 0;
VuAntiDatabase*      vuAntiDB            = 0;

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
// Internal classes...
//-----------------------------------------------------------------------------
// private class def

VuLinkNode::VuLinkNode(VuEntity* entity, VuLinkNode* next)
{
	freenext_ = 0;
	entity_ = entity;
	next_ = next;
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

VuLinkNode::~VuLinkNode()
{
	freenext_ = 0;
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

class VuTailNode : public VuLinkNode
{

public:

	VuTailNode();

};

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

VuTailNode::VuTailNode() : VuLinkNode(0, 0)
{
	next_ = this;
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

// tail (special empty end of list)
static VuTailNode TailNode;
VuLinkNode *vuTailNode = &TailNode;

VuRBNode *bogusNode = 0;

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
// VuCollection
//-----------------------------------------------------------------------------

VuCollection::VuCollection()
{
	initialized_ = FALSE;
	// empty
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

VuCollection::~VuCollection()
{
	// empty
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

void
VuCollection::Init()
{
	initialized_ = TRUE;
	vuCollectionManager->Register(this);
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

void
VuCollection::DeInit()
{
	vuCollectionManager->DeRegister(this);
	initialized_ = FALSE;
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

VU_ERRCODE 
VuCollection::Handle(VuMessage *)
{
	return VU_NO_OP;
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

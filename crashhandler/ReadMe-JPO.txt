This stuff is hacked out of the bugslayer column from MSDN
-- John Robbins - Microsoft Systems Journal Bugslayer Column - August '98

All credit goes to the original author
I changed it into a small static library and cut out a few bits to get it
to compile successfully and make it non DLL.

JPO
